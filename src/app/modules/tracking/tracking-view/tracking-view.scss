$stepper-blue: #0b4c8f;
$stepper-green: #29b366;
$stepper-gray: #c5ced8;

:host {
    .tracking-wrapper {
        padding: 20px 16px 32px;
        max-width: 980px;
        margin: 0 auto;
    }


    .tracking-title {
        color: #0a3d85;
        font-weight: 700;
        font-size: 22px;
        margin: 16px 0 12px;
    }

    .tracking-back-row {
        display: flex;
        margin-top: 0;
        margin-bottom: 0;
        margin-left: 0;
    }

    .document-header {
        padding: 0 24px 16px;
        margin-bottom: 8px;

        .document-label {
            font-size: 15px;
            font-weight: 600;
            color: #2b3e63;
        }
    }

    .cliente-id-requerido {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 64px 24px;
        text-align: center;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(16, 24, 40, 0.08);
        border: 1px solid #edeff2;
        margin-top: 16px;

        &__icon {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: #fff4e6;
            color: #f59e0b;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 16px;
            border: 2px solid #fef3c7;
        }

        &__title {
            color: #0a3d85;
            font-weight: 700;
            font-size: 20px;
            margin: 0 0 12px;
        }

        &__message {
            color: #344054;
            font-size: 16px;
            line-height: 1.5;
            margin: 0 0 8px;
            max-width: 500px;
        }

        &__submessage {
            color: #667085;
            font-size: 14px;
            line-height: 1.5;
            margin: 0;
            max-width: 500px;
        }
    }

    .back-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: transparent;
        color: #333;
        border: none;
        border-radius: 0;
        padding: 0;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: color .15s ease;
    }

    .back-badge:hover {
        color: #0a3a6b;
    }

    .back-badge .arrow {
        font-size: 20px;
        line-height: 1;
        font-weight: 600;
    }

    .back-badge .text {
        line-height: 1;
    }

    .doc-header {
        padding: 16px 0 8px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }

    .doc-title {
        font-weight: 700;
        font-size: 22px;
        color: #0a3a6b;
    }

    .doc-subtitle {
        margin-top: 4px;
        color: #9e9e9e;
        font-weight: 600;
    }

    .doc-location-row {
        margin-top: 12px;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .doc-location-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #e8f0fe;
        display: flex;
        align-items: center;
        justify-content: center;

        img {
            width: 22px;
            height: 22px;
        }
    }

    .doc-location-text {
        font-size: 22px;
        color: #111;

        .doc-location-title {
            font-weight: 600;
        }

        .doc-location-desc {
            font-weight: 500;
        }
    }

    .search-wrapper {
        margin-bottom: 8px;
    }

    .box-container {
        // Ajustar max-width para igualar el ancho efectivo con mis-compras
        // En mis-compras: wrapper tiene max-width 980px con padding 16px cada lado = 948px disponible
        // Como box-container está fuera del wrapper, necesita max-width de 948px para igualar
        max-width: 948px;
        margin: 16px auto 8px auto;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
        padding: 20px 24px;
        background: #fff;
        border-radius: 8px;

        &.no-padding {
            padding: 0;
        }
    }

    .box-container:first-of-type {
        margin-top: 32px;
    }

    .estado-movil {
        display: none;
        align-items: center;
        gap: 8px;
        color: #344054;
        margin: 4px 0 20px;
    }

    .estado-movil .estado-icon {
        width: 24px;
        height: 24px;
        display: block;
        margin: 0 -2px 0 0;
    }

    .estado-movil .estado-icon img {
        width: 24px;
        height: 24px;
        display: block;
    }

    .estado-movil .estado-text {
        font-size: 14px;
    }

    @media (max-width: 768px) {
        .hide-on-mobile {
            display: none !important;
        }

        .show-on-mobile {
            display: flex !important;
        }

        .doc-location-icon {
            width: 28px;
            height: 28px;
            display: block;
            margin: 0 0 18px 8px;
            background: transparent;
            border-radius: 0;
        }

        .doc-location-icon img {
            width: 28px;
            height: 28px;
            display: block;
        }

        .doc-location-text {
            font-size: 14px;
            margin: 0 0 14px 8px;
        }

        .doc-title {
            font-size: 18px;
            font-weight: 700;
            color: #0a3a6b;
        }
    }
}

.stepper-progress {
    font-weight: 600;
    font-size: 14px;
    margin-bottom: 8px;
    color: #2b3e63;
}

// Inline stepper styles (ported from the original tracking-stepper-view)
:host {
    .stepper-view-container {
        margin-top: 0;
        position: relative;
        margin-bottom: 0;
        padding: 8px 0 16px;
        display: flex;
        flex-direction: column;

        .step-container {
            text-align: center;
            flex: 1 1 0;
            display: flex;
            flex-direction: column;
            align-items: stretch;

            .icon-wrapper {
                position: relative;
                display: inline-flex;
                align-items: center;
                justify-content: center;
            }

            .product-count-badge {
                position: absolute;
                top: -4px;
                right: -4px;
                background: #d32f2f;
                color: #fff;
                font-size: 10px;
                line-height: 14px;
                width: 14px;
                height: 14px;
                border-radius: 7px;
                text-align: center;
                font-weight: 600;
                box-shadow: 0 0 0 1.5px #fff;
            }

            .alcanzado-text {
                margin-top: 2px;
                font-size: 11px;
                font-weight: 500;
                color: #4d4f57;
                text-align: center;
                line-height: 1.3;
            }

            .step-title {
                margin: 8px 0 4px;
                color: #2b3e63;
                font-weight: 600;
                font-size: 13px;

                p {
                    white-space: nowrap;
                    text-overflow: ellipsis;
                    display: inline-block;
                    margin: 0;
                }
            }

            .step-details {
                padding: 4px 8px 0;

                p {
                    padding: 0;
                    font-size: 11px;
                    color: #606060;
                    margin: 0 0 2px;
                }

                span,
                .date-observacion {
                    font-weight: normal;
                    font-size: 11px;
                    color: #959494;
                }
            }

            .step {
                // Ocultar pseudo-elementos - usamos step-separator en su lugar
                &::before,
                &::after {
                    display: none !important;
                }
                
                .icon {
                    width: 28px;
                    height: 28px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .step-separator {
                    position: relative;
                    height: 2px;
                    background-color: $stepper-gray;
                    border-radius: 999px;
                    overflow: hidden;

                    // No crear pseudo-elementos - usamos solo el elemento div
                    &::before,
                    &::after {
                        display: none !important;
                    }

                    &.beginning:not(.green-line) {
                        border-radius: 999px 0 0 999px;
                        background: linear-gradient(90deg, rgba(197, 206, 216, 0) 0%, rgba(197, 206, 216, 0.3) 20%, rgba(197, 206, 216, 1) 50%);
                    }

                    &.end:not(.green-line) {
                        border-radius: 0 999px 999px 0;
                        background: linear-gradient(90deg, rgba(197, 206, 216, 1) 50%, rgba(197, 206, 216, 0.3) 80%, rgba(197, 206, 216, 0) 100%);
                    }
                    
                    // Cuando es green-line, eliminar cualquier background
                    &.green-line {
                        background-color: transparent !important;
                        background: none !important;
                        overflow: visible !important;
                    }
                }

                &.in-progress {
                    .step-separator {
                        background-color: transparent;
                    }

                    &.last:not(.completed) {
                        .step-separator {
                            &.to {
                                background-color: transparent;

                                &::after {
                                    background-image: none;
                                }
                            }
                        }
                    }

                }

                &.completed {
                    .step-separator:not(.green-line) {
                        background-color: $stepper-blue;

                        &.beginning {
                            background: linear-gradient(90deg, rgba(11, 76, 143, 0) 0%, rgba(11, 76, 143, 0.3) 20%, rgba(11, 76, 143, 1) 50%);
                        }

                        &.end {
                            background: linear-gradient(90deg, rgba(11, 76, 143, 1) 50%, rgba(11, 76, 143, 0.3) 80%, rgba(11, 76, 143, 0) 100%);
                        }
                    }

                    &.in-progress {
                        .step-separator {
                            &.from:not(.green-line) {
                                background-color: $stepper-blue !important;
                                border: 0;
                                margin: 0 auto;
                            }
                        }

                        &.last {
                            .step-separator {
                                &.to:not(.end):not(.green-line) {
                                    background-color: transparent !important;
                                    border-radius: 0;
                                    margin: 0 2px;
                                }
                            }
                        }
                    }

                }

                &.last {
                    .step-separator {
                        &.to {
                            background-color: $stepper-gray;
                            
                            // Gradiente gris para el último paso pendiente
                            &.end:not(.green-line) {
                                background: linear-gradient(90deg, rgba(197, 206, 216, 1) 50%, rgba(197, 206, 216, 0.3) 80%, rgba(197, 206, 216, 0) 100%);
                            }

                            &::after {
                                background-image: none;
                            }
                        }
                    }
                    
                }
                
                // Gradiente azul para el último paso completado (sin green-line)
                &.last.completed:not(.in-progress) .step-separator.to.end:not(.green-line) {
                    background: linear-gradient(90deg, rgba(11, 76, 143, 1) 50%, rgba(11, 76, 143, 0.3) 80%, rgba(11, 76, 143, 0) 100%) !important;
                }
                
                // Asegurar que el gradiente gris tenga suficiente especificidad
                &.last:not(.completed) .step-separator.to.end:not(.green-line) {
                    background: linear-gradient(90deg, rgba(197, 206, 216, 1) 50%, rgba(197, 206, 216, 0.3) 80%, rgba(197, 206, 216, 0) 100%) !important;
                }
            }
        }

        &.vertical {
            box-shadow: none;
            margin-top: 0px;

            .step-container {
            .step-title {
                text-align: left;
                margin: 20px 0 0 12px;

                &.beginning {
                    margin-top: 0;
                }

                .title {
                    white-space: nowrap;
                    text-overflow: ellipsis;
                    color: #2b3e63;
                    font-weight: 600;
                    font-size: 13px;
                    margin-bottom: 2px;
                    display: block;
                }

                .sub-title {
                    font-size: 11px;
                    color: #606060;
                    margin-bottom: 2px;
                    line-height: 1.3;
                }

                .date {
                    font-size: 11px;
                    font-weight: normal;
                    color: #959494;
                }
            }

                .step {
                    .step-separator {
                        width: 2px;
                        min-height: 35px;
                        margin: -3px auto 0;
                        height: auto;

                        &.beginning {
                            border-radius: 5px 5px 0 0;
                        }

                        &.end {
                            border-radius: 0 0 5px 5px;
                        }
                    }

                    &.beginning {
                        margin-top: 10px;
                    }
                }
            }
        }
    }

    .fadingEffect {
        position: absolute;
        top: 0;
        bottom: 0;
        right: 0;
        width: 0%;
        background: white;
        animation: showHide 1s ease-in alternate infinite;
        animation-iteration-count: 1;
        background: linear-gradient(to right, transparent 0%, white 10%);
    }
}

@keyframes showHide {
    0% {
        width: 100%
    }

    100% {
        width: 0%
    }
}

:host {
    .step .icon.pending {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #e5e8ed;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        color: #9ca3af;
        border: 1px solid #d1d5db;
    }
}

// ============================================================================
// Mobile vertical alignment - NUEVA IMPLEMENTACIÓN CON FLEXBOX
// Las líneas salen del icono hacia arriba (from) y hacia abajo (to)
// ============================================================================
@media (max-width: 768px) {
    :host {
        .stepper-view-container.mobile-vertical {
            box-shadow: none;
            padding: 4px 16px 12px 16px;
            position: relative;
            display: flex;
            flex-direction: column;
            
            .step-container {
                display: flex;
                flex-direction: row;
                align-items: stretch;
                min-height: 80px;

                // ========================================================================
                // COLUMNA DEL ICONO Y LÍNEAS (step)
                // Estructura flex-column: [from] [icono] [to]
                // ========================================================================
                .step {
                    display: flex !important;
                    flex-direction: column !important;
                    align-items: center !important;
                    min-width: 50px;
                    padding: 0 !important;
                    position: relative;
                    
                    .icon-wrapper {
                        position: relative;
                        z-index: 10;
                        flex-shrink: 0;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        order: 1; // Icono en el medio
                    }
                    
                    .icon {
                        margin: 0 !important;
                        width: 28px;
                        height: 28px;
                        flex-shrink: 0;
                    }
                    
                    // ========================================================================
                    // SEPARADORES VERTICALES - flex-grow para llenar el espacio
                    // ========================================================================
                    .step-separator {
                        width: 2px;
                        flex: 1 1 auto;
                        min-height: 20px;
                        background-color: $stepper-gray;
                        margin: 0;
                        position: relative;
                        display: block !important;
                        
                        &.from {
                            order: 0; // Arriba del icono
                        }
                        
                        &.to {
                            order: 2; // Abajo del icono
                        }
                        
                        // Primer paso: difuminar hacia arriba
                        &.beginning:not(.green-line) {
                            background: linear-gradient(
                                to bottom,
                                rgba(197, 206, 216, 0) 0%,
                                rgba(197, 206, 216, 0.3) 30%,
                                rgba(197, 206, 216, 1) 100%
                            );
                        }
                        
                        // Último paso: difuminar hacia abajo
                        &.end:not(.green-line) {
                            background: linear-gradient(
                                to bottom,
                                rgba(197, 206, 216, 1) 0%,
                                rgba(197, 206, 216, 0.3) 70%,
                                rgba(197, 206, 216, 0) 100%
                            );
                        }
                        
                        // ========================================================================
                        // LÍNEA VERDE PUNTEADA
                        // ========================================================================
                        &.green-line {
                            background-color: transparent !important;
                            background: none !important;
                            border-left: 3px dotted #00aa00 !important;
                            border-top: none !important;
                            border-right: none !important;
                            border-bottom: none !important;
                            width: 0 !important;
                            margin-left: 1px !important;
                            
                            &.beginning,
                            &.end {
                                background: none !important;
                            }
                        }
                    }
                    
                    // ========================================================================
                    // PASO COMPLETADO: líneas azules
                    // ========================================================================
                    &.completed {
                        .step-separator:not(.green-line) {
                            background-color: $stepper-blue;
                        }
                        
                        .step-separator.from.beginning:not(.green-line) {
                            background: linear-gradient(
                                to bottom,
                                rgba(11, 76, 143, 0) 0%,
                                rgba(11, 76, 143, 0.3) 30%,
                                rgba(11, 76, 143, 1) 100%
                            ) !important;
                        }
                        
                        &.last .step-separator.to.end:not(.green-line) {
                            background: linear-gradient(
                                to bottom,
                                rgba(11, 76, 143, 1) 0%,
                                rgba(11, 76, 143, 0.3) 70%,
                                rgba(11, 76, 143, 0) 100%
                            ) !important;
                        }
                    }
                    
                    // Paso en progreso: from azul
                    &.completed.in-progress {
                        .step-separator.from:not(.green-line) {
                            background-color: $stepper-blue !important;
                        }
                    }
                    
                    // Último paso pendiente: gradiente gris
                    &.last:not(.completed) {
                        .step-separator.to.end:not(.green-line) {
                            background: linear-gradient(
                                to bottom,
                                rgba(197, 206, 216, 1) 0%,
                                rgba(197, 206, 216, 0.3) 70%,
                                rgba(197, 206, 216, 0) 100%
                            ) !important;
                        }
                    }
                }

                // ========================================================================
                // COLUMNA DEL TEXTO (step-title)
                // ========================================================================
                .step-title {
                    text-align: left;
                    margin: 0;
                    padding: 0 0 0 12px;
                    overflow-x: hidden;
                    flex: 1;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;

                    .title {
                        color: #4d4f57;
                        font-weight: bold;
                        margin-bottom: 2px;
                        font-size: 14px;
                    }

                    .sub-title {
                        font-size: 12px;
                        color: #606060;
                        margin-bottom: 2px;
                        line-height: 1.25;
                    }

                    .date {
                        font-size: 12px;
                        font-weight: normal;
                        color: #959494;
                    }
                }
            }

            .product-count-badge {
                position: absolute;
                top: -6px;
                right: -6px;
                background: #d32f2f;
                color: #fff;
                font-size: 11px;
                line-height: 16px;
                width: 16px;
                height: 16px;
                border-radius: 8px;
                text-align: center;
                font-weight: 600;
                box-shadow: 0 0 0 2px #fff;
                z-index: 20;
            }
        }
    }
}

// Estilos Resumen de tu compra
.purchase-summary-card {
    padding: 20px 0 24px;

    h3 {
        font-size: 16px;
        font-weight: 600;
        margin: 0 0 4px;
    }

    .document-info {
        font-size: 14px;
        color: #666;
        margin: 0 0 16px;
    }

    .tipo-entrega-row {
        display: flex;
        align-items: flex-start;
        gap: 16px;
    }

    .icon-col {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: #e8f0fe;
        flex-shrink: 0;
        position: relative;
    }

    .icon-col.tienda {
        background: #e8f0fe url('~src/assets/tienda-icon.svg') center/40px 40px no-repeat;
    }

    .icon-col.domicilio {
        background: #e8f0fe url('~src/assets/domicilio-icon.svg') center/40px 40px no-repeat;
    }

    .data-col {
        flex: 1;
    }

    .data-col .tipo {
        font-weight: 500;
        font-size: 14px;
        margin: 0 0 4px;
    }

    .data-col .direccion {
        font-size: 13px;
        margin: 0 0 6px;
        font-weight: 400;
        color: #2b2b2b;
    }

    .data-col .fecha-compra {
        font-size: 12px;
        margin: 4px 0 0;
        color: #555;
    }
}

@media (max-width: 768px) {
    .purchase-summary-card {
        padding: 16px 0 20px;
    }

    .purchase-summary-card h3 {
        margin-bottom: 12px;
    }

    .purchase-summary-card .icon-col {
        width: 40px;
        height: 40px;
        background-size: 32px 32px;
    }

    .purchase-summary-card .data-col .tipo {
        font-size: 13px;
    }

    .purchase-summary-card .data-col .direccion {
        font-size: 12px;
    }

    .purchase-summary-card .data-col .fecha-compra {
        font-size: 11px;
    }
}

// Estilos productos pedido
.pedido-summary-card {
    padding: 20px 0 24px;

    h3 {
        font-size: 16px;
        font-weight: 600;
        margin: 0 0 12px;
    }

    .sub {
        font-size: 14px;
        font-weight: 500;
        margin: 0 0 4px;
    }

    .sub-line {
        height: 2px;
        background: #d21313;
        width: 100%;
        margin: 0 0 16px;
    }

    .productos-wrapper {
        margin-top: 4px;
    }

    .productos-list {
        display: flex;
        flex-direction: column;
    }

    .producto-item {
        display: flex;
        align-items: stretch;
        position: relative;
        padding: 12px 0;
    }

    .producto-item:first-child {
        padding-top: 0;
    }

    .left-block {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        flex: 1;
    }

    .right-block {
        display: flex;
        align-items: flex-start;
        justify-content: flex-end;
        min-width: 140px;
    }

    .producto-img {
        width: 56px;
        height: 56px;
        object-fit: cover;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        background: #fafafa;
    }

    .img-col {
        flex-shrink: 0;
    }

    .info-col {
        flex: 1;
    }

    .info-col .nombre {
        font-size: 13px;
        font-weight: 500;
        margin: 0 0 6px;
        line-height: 1.25;
        color: #2b2b2b;
    }

    .info-col .cantidad {
        font-size: 12px;
        margin: 0 0 4px;
        font-weight: 500;
        color: #0a3a6b;
    }

    .sku-inline {
        font-size: 12px;
        font-weight: 400;
        color: #2b2b2b;
        padding-top: 4px;
    }

    .row-separator {
        position: absolute;
        left: 0;
        bottom: 0;
        width: 100%;
        height: 1px;
        background: #e5e5e5;
    }
}

@media (max-width: 768px) {
    .pedido-summary-card {
        padding: 16px 0 20px;
    }

    .pedido-summary-card .producto-img {
        width: 48px;
        height: 48px;
    }

    .pedido-summary-card .info-col .nombre {
        font-size: 12px;
    }

    .pedido-summary-card .info-col .cantidad {
        font-size: 11px;
    }

    .pedido-summary-card .sku-inline {
        font-size: 11px;
    }
}
// Estilos para l�neas verdes punteadas (pendientes despu�s de completados)
// ============================================================================
// REGLAS PARA LÍNEAS VERDES PUNTEADAS (consistentes con mis-compras)
// ============================================================================
.step-separator.green-line {
    // Línea punteada verde con espaciado mejorado
    // Usar 6px en lugar de 4px para que los puntos sean más grandes y espaciados
    border-top: 3px dotted #00aa00 !important;
    margin-right: 3px;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
    background-color: transparent !important;
    background: none !important;
    background-image: none !important;
    height: 0 !important;
    overflow: visible !important;
    border-radius: 0 !important;
    z-index: 5 !important;
    
    // Los gradientes no deben aplicarse a líneas verdes
    &.beginning,
    &.end {
        background: none !important;
        background-image: none !important;
        border-radius: 0 !important;
    }
}

// REGLA FINAL: Asegurar que NO haya ningún background en green-line, incluso de reglas más específicas
.stepper-view-container .step .step-separator.green-line,
.stepper-view-container .step-container .step .step-separator.green-line,
.stepper-view-container .step.completed .step-separator.green-line,
.stepper-view-container .step.in-progress .step-separator.green-line,
.stepper-view-container .step.last .step-separator.green-line {
    background-color: transparent !important;
    background: none !important;
    background-image: none !important;
}
