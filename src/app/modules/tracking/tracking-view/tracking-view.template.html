<div class="tracking-back-row" *ngIf="invoice">
    <button class="back-badge" (click)="volver()">
        <span class="arrow">‚Üê</span>
        <span class="text">Volver</span>
    </button>
</div>

<div class="box-container" *ngIf="stepperSteps && stepperSteps.length">
  <div class="stepper-progress" *ngIf="completedCount() > 0">
    {{completedCount()}} de {{totalCanonical()}} pasos
  </div>
  <app-tracking-stepper-view [steps]="stepperSteps" [orderDetails]="invoice?.orderProducts"></app-tracking-stepper-view>
</div>

<!-- Card: Resumen de tu compra -->
<div class="box-container" *ngIf="invoice">
  <div class="purchase-summary-card">
    <h3>Resumen de tu compra</h3>
    <div class="tipo-entrega-row">
      <div class="icon-col" [ngClass]="{'tienda': resumenTipoEntrega() === 'Retiro en Tienda', 'domicilio': resumenTipoEntrega() !== 'Retiro en Tienda'}"></div>
      <div class="data-col">
        <p class="tipo">{{resumenTipoEntrega()}}</p>
        <p class="direccion" *ngIf="direccionEntrega()">{{direccionEntrega()}}</p>
        <p class="fecha-compra" *ngIf="invoice.issueDate">Fecha de compra: {{invoice.issueDate | date:'dd-MM-yyyy'}}</p>
      </div>
    </div>
  </div>
</div>

<!-- Card: Resumen de tu pedido -->
<div class="box-container" #orderDetailsView>
  <div class="pedido-summary-card">
    <h3>Resumen de tu pedido</h3>
    <h4 class="sub">{{ productSubtitle() }}</h4>
    <div class="sub-line"></div>
    <div class="productos-wrapper" *ngIf="invoice?.orderProducts?.length">
      <div class="productos-list">
        <div class="producto-item" *ngFor="let p of invoice?.orderProducts; let i = index">
          <div class="left-block">
            <div class="img-col">
              <img class="producto-img" [src]="p.image || 'assets/not-image.jpg'" (error)="onImgError($event)" alt="producto" />
            </div>
            <div class="info-col">
              <p class="nombre">{{ p.description }}</p>
              <p class="cantidad">{{ p.quantity === 1 ? '1 UNIDAD' : (p.quantity + ' UNIDADES') }}</p>
            </div>
          </div>
          <div class="right-block" *ngIf="p.code">
            <span class="sku-inline">SKU {{ p.code }}</span>
          </div>
          <div class="row-separator" *ngIf="i < ((invoice?.orderProducts?.length || 0) - 1)"></div>
        </div>
      </div>
    </div>
  </div>
</div>



